import pandas as pd

# assume your 24Q2 dataframe is df
dq = df[['SCORE', 'LOANPURPOSECATEGORY', 'TARGET', 'SCORE_DATE', 'APP_ID']].copy()

# Force SCORE_DATE to be tz-aware UTC (mixed tz / strings become consistent; bad rows -> NaT)
sd = pd.to_datetime(dq['SCORE_DATE'], errors='coerce', utc=True)

# tz-aware "today" in UTC
today_utc = pd.Timestamp.now(tz='UTC').normalize()

# Now this comparison is tz-aware vs tz-aware (no tz-naive anywhere)
future = sd.gt(today_utc) & sd.notna()

print("SCORE_DATE unparsable / missing:", int(sd.isna().sum()))
print("SCORE_DATE min:", sd.min())
print("SCORE_DATE max:", sd.max())
print("Future-dated SCORE_DATE rows:", int(future.sum()))
